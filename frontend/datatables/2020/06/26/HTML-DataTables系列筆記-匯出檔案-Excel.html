<!DOCTYPE html>
<html>







<head>
  <meta charset="utf-8">
  <title>
    JYU Blog - HTML-DataTables系列筆記-匯出檔案-Excel
  </title>
  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"
    integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa"
    crossorigin="anonymous"></script>

  <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js"></script>

  <!-- 針對是否為Production Mode對應特定Js套件來源引入 -->
  <!-- 

  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.2.29/vue.global.prod.min.js"
    integrity="sha512-NZwTAzVi1EAKCNv0XBX0j3+4UyjSlMjYSrfZw9l8Vi+oSCMUWhnadIBcqbODVuird9fAsl5fx6ysQT2lGxsQjw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

   -->

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/MainStyles.css" />
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
    integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@latest/pace-theme-default.min.css">
</head>







<body>
  






<div class="container">
    <header
        class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4 border-bottom">

        <div class="col-md-3 text-start fs-3">
            JYU Blog
        </div>

        <ul class="nav nav-pills col-12 col-md-auto mb-2 fs-5 justify-content-center mb-md-0">
            <li class="nav-item">
                <a class="nav-link text-body" href="/" class="nav-link px-2 link-secondary">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link text-body" href="/about" class="nav-link px-2 link-secondary">About</a>
            </li>
        </ul>

        <div class="col-md-3 text-end">
        </div>

    </header>
</div>
  






<main class="container-sm">
    <nav style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='currentColor'/%3E%3C/svg%3E&#34;);"
        aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><i class="fas fa-home"></i> <a href="/">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">HTML-DataTables系列筆記-匯出檔案-Excel</li>
        </ol>
    </nav>
    <hr />
</main>

  <main class="container-sm">

    <div class="mb-3">
      <span class="fs-3" style="color: #A6341B;">HTML-DataTables系列筆記-匯出檔案-Excel</span>
      <br />
      <span class="fs-6 opacity-75 text-secondary">
        <i class="fas fa-clock text-info"></i>
        2020-06-26 12:56:00
      </span>
    </div>

    <!--more-->

<p>在下載Datatables 套件包時，在<code class="language-plaintext highlighter-rouge">Extensions</code>內部<strong>Buttons</strong>項目記得要勾選</p>
<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />HTML5 export</li>
</ul>

<p>這樣才會把必要模組功能一起包進套件包裡。</p>

<p>關鍵參數設置
Datatables 主體渲染樣式設置</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">dom</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bfrtip</span><span class="dl">'</span>
</code></pre></div></div>

<p>最重要的是<code class="language-plaintext highlighter-rouge">B</code>這個值，要開啟Datatables Button 功能模組。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">buttons</span><span class="p">:</span> <span class="p">[</span> <span class="p">]</span>
</code></pre></div></div>
<p>這裡面可以定義Button功能模組內有哪些，例如在官方說明文件可以看到有這些</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'copy', 'csv', 'excel', 'pdf', 'print'
</code></pre></div></div>
<ul>
  <li>copy –&gt; 複製整個Datatables內容。</li>
  <li>csv –&gt; 將整個Datatables內容匯出成csv檔案下載。</li>
  <li>excel –&gt; 將整個Datatables內容匯出成excel檔案下載。</li>
  <li>pdf –&gt; 將整個Datatables內容匯出成pdf檔案下載。</li>
  <li>print –&gt; 將整個Datatables內容進行列印。</li>
</ul>

<p>不使用官方預設配置，改為以下設置下載Excel為例</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">buttons</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="na">extend</span><span class="p">:</span> <span class="dl">'</span><span class="s1">excelHtml5</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">MyDatatables_Excel</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">匯出Excel</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">customize</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">xlsx</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">],</span>
</code></pre></div></div>

<ul>
  <li>extend –&gt; 此按鈕繼承自哪一個模組，在這裡要繼承<code class="language-plaintext highlighter-rouge">'excelHtml5'</code>，此為模組名稱。</li>
  <li>title –&gt; 檔案名稱與標題都跟此參數有關，如果沒設置的話會跑預設Datatables自己定義名稱。</li>
  <li>text –&gt; 按鈕顯示名稱。</li>
  <li>customize –&gt; 如果要針對內部資料內容做設置，在此進行資料處理。</li>
</ul>

<p>預設匯出下載的內容整個第一列(A)會是一個跨欄置中的標題列，內部標題依據<code class="language-plaintext highlighter-rouge">title</code>設定的值。</p>

<hr />

<h4 id="相關參考">相關參考</h4>

<ul>
  <li><a href="https://datatables.net/reference/option/dom">DOM</a></li>
  <li><a href="https://datatables.net/reference/button/">Buttons</a></li>
  <li><a href="https://datatables.net/extensions/buttons/examples/html5/filename.html">File name</a></li>
  <li><a href="https://datatables.net/extensions/buttons/examples/initialisation/export.html">File export</a></li>
  <li><a href="https://datatables.net/reference/button/excel">excel</a></li>
</ul>



    <script src="https://utteranc.es/client.js" repo="s123600g/s123600g.github.io"
      issue-term="title" theme="boxy-light"
      label="Article" crossorigin="anonymous" async></script>
  </main>
</body>

<div class="container">
    <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
        <div class="col-md-4 d-flex align-items-center">
            <a href="/" class="mb-3 me-2 mb-md-0 text-muted text-decoration-none lh-1">
                <svg class="bi" width="30" height="24">
                    <use xlink:href="#bootstrap"></use>
                </svg>
            </a>
            <span class="text-muted">© 2023 JYUN YU LI. All rights reserved.</span>
        </div>

        <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
            <li class="ms-3">
                <a class="text-muted" href="https://github.com/s123600g" target="_blank">
                    <i class="fab fa-github fs-3"></i>
                </a>
            </li>

            <li class="ms-3">
                <a class="text-muted" href="mailto://s123600g@gmail.com">
                    <i class="fas fa-envelope fs-3"></i>
                </a>
            </li>
        </ul>
    </footer>
</div>

</html>